document.addEventListener('DOMContentLoaded',function(){flatpickr(document.querySelectorAll('.datetime-picker'),{enableTime:true,dateFormat:"Y-m-d\\TH:i:S",defaultHour:0,altFormat:"Y-m-d\\TH:i:S",allowInput:true,time_24hr:true,});function renderTable(data){let tableBody='';let keys=['_id','flare_id','start','end','GOES_class','link_dspec_data','link_movie','link_fits'];data.forEach((item)=>{tableBody+='<tr>';keys.forEach((key)=>{tableBody+='<td>'+(item[key]||'')+'</td>';});tableBody+='</tr>';});$('#flare-list').show();$('#flare-list > tbody').html(tableBody);}
function showError(message){alert(message);}
$('#query-btn').on('click',function(e){e.preventDefault();let start=$('#start').val();let end=$('#end').val();$.ajax({url:'/api/flare/query',type:"POST",data:{'start':start,'end':end},dataType:"json",success:function(response){if(response.error){showError(response.error);}else{renderTable(response.result);$('#plot-container').html(response.plot_html);}},error:function(xhr,status,error){console.error("Error occurred: "+error);showError("An error occurred while processing your request.");}});});});